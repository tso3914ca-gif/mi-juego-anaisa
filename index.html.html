<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Misi√≥n: Exploraci√≥n Vital</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root { 
            --rojo-brillante: #ff4757; 
            --azul-cool: #1e90ff; 
            --verde-game: #2ed573; 
            --amarillo-star: #ffa502;
            --morado: #5352ed;
            --oscuro: #2f3542;
        }
        
        body { 
            font-family: 'Comic Sans MS', 'Segoe UI', cursive, sans-serif; 
            background: linear-gradient(rgba(162, 210, 255, 0.8), rgba(255, 255, 255, 0.8)), 
                        url('https://img.freepik.com/vector-gratis/diagrama-sistema-circulatorio-humano-organos-internos_1308-111511.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0;
        }

        h1 { 
            color: white; font-size: 35px; text-shadow: 3px 3px 0px var(--rojo-brillante);
            background: var(--azul-cool); padding: 12px 40px; border-radius: 50px;
            box-shadow: 0 6px 0 #0e6ecc; margin: 10px 0; border: 4px solid white;
        }

        .dashboard { 
            display: flex; gap: 20px; margin-bottom: 15px; background: rgba(255,255,255,0.9); 
            padding: 10px 30px; border-radius: 25px; border: 4px solid var(--azul-cool);
            backdrop-filter: blur(5px);
        }

        .stat { font-size: 20px; font-weight: bold; }

        .game-wrapper { display: flex; gap: 20px; align-items: flex-start; justify-content: center; flex-wrap: wrap; }

        .board-bg { 
            background: rgba(255,255,255,0.9); padding: 10px; border-radius: 20px;
            border: 6px solid var(--morado); box-shadow: 0 8px 0 #3b3bbb;
        }

        .grid { display: grid; grid-template-columns: repeat(15, 30px); gap: 3px; }
        
        .cell { 
            width: 30px; height: 30px; background: white; display: flex; 
            align-items: center; justify-content: center; font-size: 15px; font-weight: 900; 
            cursor: pointer; border-radius: 6px; user-select: none; transition: 0.1s;
            color: var(--oscuro); border-bottom: 2px solid #ced6e0;
        }
        
        .cell:hover { background: var(--amarillo-star); color: white; transform: scale(1.1); }
        .cell.selected { background: var(--azul-cool); color: white; }
        .cell.found { background: var(--verde-game); color: white; border-bottom: none; animation: pop 0.3s; }

        @keyframes pop { 0% {transform: scale(1);} 50% {transform: scale(1.2);} 100% {transform: scale(1);} }

        .word-bank { 
            width: 260px; background: rgba(255,255,255,0.9); padding: 15px; border-radius: 20px;
            border: 5px solid var(--amarillo-star); box-shadow: 0 6px 0 #e69500;
        }

        .word-list { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        
        .word-item { 
            background: white; padding: 6px; border-radius: 8px; font-size: 11px;
            font-weight: bold; text-align: center; color: #57606f; border: 1px solid #ddd;
        }
        .word-item.done { background: var(--verde-game); color: white; text-decoration: line-through; border-color: transparent; }

        .console { 
            margin-top: 15px; width: 600px; background: rgba(47, 53, 66, 0.95); color: #7bed9f;
            padding: 15px; border-radius: 15px; border-left: 10px solid var(--rojo-brillante);
            font-family: 'Courier New', monospace; font-size: 14px; min-height: 45px;
        }

        .btn-new {
            margin-top: 15px; background: var(--rojo-brillante); color: white;
            padding: 12px 30px; border: none; border-radius: 20px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            box-shadow: 0 5px 0 #b33939; transition: 0.2s;
        }
    </style>
</head>
<body>

    <h1>üöÄ EXPLORACI√ìN VITAL</h1>

    <div class="dashboard">
        <div class="stat" style="color: var(--rojo-brillante)">‚ù§Ô∏è RELOJ: <span id="time">07:00</span></div>
        <div class="stat" style="color: var(--azul-cool)">‚≠ê LOGROS: <span id="prog">0 / 15</span></div>
    </div>

    <div class="game-wrapper">
        <div class="board-bg">
            <div class="grid" id="grid"></div>
        </div>

        <div class="word-bank">
            <h3 style="margin-top:0; text-align:center; color: var(--morado); font-size: 18px; text-transform: uppercase;">üì° OBJETIVOS DE LA MISI√ìN</h3>
            <div id="list" class="word-list"></div>
        </div>
    </div>

    <div class="console" id="msg-box">
        >> INICIANDO ESC√ÅNER BIOM√âTRICO... Localiza los 15 objetivos.
    </div>

    <button class="btn-new" onclick="location.reload()">üîÑ REINICIAR MISI√ìN</button>

    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTone(freq, type, dur) {
            try {
                const osc = audioCtx.createOscillator();
                const gain = audioCtx.createGain();
                osc.type = type; osc.frequency.value = freq;
                gain.gain.setValueAtTime(0.05, audioCtx.currentTime);
                osc.connect(gain); gain.connect(audioCtx.destination);
                osc.start(); osc.stop(audioCtx.currentTime + dur);
            } catch(e) {}
        }

        const misiones = {
            "CORAZON": "‚ù§Ô∏è ¬°Es el motor r√≠tmico de tu cuerpo!",
            "VENAS": "üîµ Sangre que retorna para ser oxigenada.",
            "ARTERIAS": "üî¥ Distribuyen nutrientes con mucha presi√≥n.",
            "SANGRE": "üíâ El fluido que transporta la vida.",
            "AORTA": "üìè La v√≠a principal de salida del coraz√≥n.",
            "PLASMA": "üíß El mar l√≠quido donde nadan las c√©lulas.",
            "PLAQUETAS": "ü©π Escuadr√≥n de reparaci√≥n inmediata.",
            "OXIGENO": "üå¨Ô∏è Gas vital para generar energ√≠a.",
            "PULMONES": "‚òÅÔ∏è Estaci√≥n de carga de aire limpio.",
            "VALVULAS": "üö™ Controladores de flujo de una sola v√≠a.",
            "AURICULA": "üè† C√°mara receptora de sangre venosa.",
            "VENTRICULO": "üöÄ Potente eyector de flujo sangu√≠neo.",
            "CAPILARES": "üï∏Ô∏è Conexiones microsc√≥picas entre vasos.",
            "GLOBULOS": "üî¥ Transportadores y defensores celulares.",
            "CIRCULACION": "üîÑ El circuito cerrado m√°s perfecto del mundo."
        };

        const wordNames = Object.keys(misiones);
        const size = 15;
        let found = 0, first = null, time = 420, active = true;
        const gridData = Array(size).fill().map(() => Array(size).fill(''));
        const placedWords = [];

        function placeWords() {
            wordNames.forEach(word => {
                let placed = false;
                let tries = 0;
                while (!placed && tries < 500) {
                    const rev = Math.random() > 0.4;
                    const wDisplay = rev ? word.split('').reverse().join('') : word;
                    const dir = Math.random() > 0.5 ? 'H' : 'V';
                    const r = Math.floor(Math.random() * (size - (dir==='V' ? word.length : 0)));
                    const c = Math.floor(Math.random() * (size - (dir==='H' ? word.length : 0)));
                    
                    let can = true;
                    for (let i = 0; i < word.length; i++) {
                        let curR = r + (dir === 'V' ? i : 0);
                        let curC = c + (dir === 'H' ? i : 0);
                        if (gridData[curR][curC] !== '' && gridData[curR][curC] !== wDisplay[i]) {
                            can = false; break;
                        }
                    }

                    if (can) {
                        for (let i = 0; i < word.length; i++) {
                            gridData[r + (dir === 'V' ? i : 0)][c + (dir === 'H' ? i : 0)] = wDisplay[i];
                        }
                        placedWords.push({ w: word, r, c, d: dir, rev });
                        placed = true;
                    }
                    tries++;
                }
            });
        }

        placeWords();

        const gridEl = document.getElementById('grid');
        for(let r=0; r<size; r++){
            for(let c=0; c<size; c++){
                const d = document.createElement('div');
                d.className = 'cell';
                d.textContent = gridData[r][c] || "ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)];
                d.dataset.r = r; d.dataset.c = c;
                d.onclick = () => {
                    if(!active) return;
                    playTone(400, 'sine', 0.1);
                    if(!first) { first = d; d.classList.add('selected'); }
                    else { check(first, d); first.classList.remove('selected'); first = null; }
                };
                gridEl.appendChild(d);
            }
        }

        function check(c1, c2) {
            let hit = false;
            const r1 = parseInt(c1.dataset.r), c1c = parseInt(c1.dataset.c);
            const r2 = parseInt(c2.dataset.r), c2c = parseInt(c2.dataset.c);

            placedWords.forEach(p => {
                const rF = p.r + (p.d=="V"?p.w.length-1:0), cF = p.c + (p.d=="H"?p.w.length-1:0);
                const match = (r1==p.r && c1c==p.c && r2==rF && c2c==cF) || (r2==p.r && c2c==p.c && r1==rF && c1c==cF);
                
                if(match) {
                    const tag = document.getElementById('t-'+p.w);
                    if(tag.classList.contains('done')) return;
                    hit = true; playTone(900, 'square', 0.2);
                    for(let i=0; i<p.w.length; i++) gridEl.children[(p.r+(p.d=="V"?i:0))*size+(p.c+(p.d=="H"?i:0))].classList.add('found');
                    tag.classList.add('done');
                    found++;
                    document.getElementById('prog').textContent = found + " / 15";
                    document.getElementById('msg-box').innerHTML = `üåü OBJETIVO LOCALIZADO: ${p.w}<br>> ${misiones[p.w]}`;
                    if(found === 15) { 
                        active = false; confetti(); 
                        document.getElementById('msg-box').innerHTML = "üèÜ MISI√ìN FINALIZADA CON √âXITO!";
                    }
                }
            });
            if(!hit) playTone(150, 'sawtooth', 0.2);
        }

        wordNames.sort().forEach(w => {
            const d = document.createElement('div');
            d.id = 't-'+w; d.className = 'word-item'; d.textContent = w;
            document.getElementById('list').appendChild(d);
        });

        const countdown = setInterval(() => {
            if(time > 0 && active) {
                time--;
                let m = Math.floor(time/60), s = time%60;
                document.getElementById('time').textContent = (m<10?'0'+m:m) + ":" + (s<10?'0'+s:s);
            } else if (time <= 0 && active) {
                active = false;
                document.getElementById('msg-box').innerHTML = "üö® ALERTA: Tiempo agotado.";
                gridEl.style.opacity = "0.4";
            }
        }, 1000);
    </script>
</body>
</html>